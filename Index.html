<!DOCTYPE html>
<html>
    <head>        
        
  <!-- CI Journeys Web Tracking Script -->


        <script>
                (function (a, t, i) { var e = "MSCI"; var s = "Analytics"; var o = e + "queue"; a[o] = a[o] || []; var r = a[e] || function (n) { var t = {}; t[s] = {}; function e(e) { while (e.length) { var r = e.pop(); t[s][r] = function (e) { return function () { a[o].push([e, n, arguments]) } }(r) } } var r = "track"; var i = "set"; e([r + "Event", r + "View", r + "Action", i + "Config", i + "Property", i + "User", "initialize", "teardown"]); return t }(i.name); var n = i.name; if (!a[e]) { a[n] = r[s]; a[o].push(["new", n]); setTimeout(function () { var e = "script"; var r = t.createElement(e); r.async = 1; r.src = i.src; var n = t.getElementsByTagName(e)[0]; n.parentNode.insertBefore(r, n) }, 1) } else { a[n] = new r[s] } if (i.user) { a[n].setUser(i.user) } if (i.props) { for (var c in i.props) { a[n].setProperty(c, i.props[c]) } } a[n].initialize(i.cfg) })(window, document, {

                    src: "https://cxppusa1rdrect01sa02cdn-endpoint.azureedge.net/webtracking/WebTracking/WebTracking.bundle.js",
                    name: "MSCI",
                    cfg: {

                        ingestionKey: "0684faad1fa84f51a61927c82a2b9ee8-96bcd81d-fe4d-4475-89f0-e3fcff0d9fe7-7575",
                        endpointUrl: "https://mobile.events.data.microsoft.com/OneCollector/1.0/",
                        autoCapture: {
                            view: true,
                            click: true
                        },
                        orgInfo: {
                            orgId: "6e80e1eb-af41-4507-9f42-68851f1951c2",
                            orgTenantId: "f2ad4d2a-2b3f-4e20-b9c2-0b4ed161543b",
                            orgGeo: "USA"
                        }
                    }
                });
        </script>

  <!-- CI Journeys Web Tracking Script -->
        
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>CI Journeys Form Test</title>
        <meta name="referrer" content="never">
        <meta type="xrm/designer/setting" name="type" value="marketing-designer-content-editor-document">
        <meta type="xrm/designer/setting" name="layout-editable" value="marketing-designer-layout-editable">
    </head>
    <body>
<form id="form1">
<input name="firstname" type="text" placeholder="First Name" required>
<input name="lastname" type="text" placeholder="Last Name" required>
<input name="emailaddress1" type="email" placeholder="Email Address" required>
<button type="submit">Submit</button>
</form>
  <h1>CI Journeys Tracking + Form Test</h1>

  <!-- CI Journeys Form Embed -->

<script src='https://cxppusa1formui01cdnsa01-endpoint.azureedge.net/usa/FormCapture/FormCapture.bundle.js'></script>
<script>
    // NOTE: for reference see https://go.microsoft.com/fwlink/?linkid=2250770

    d365mktformcapture.waitForElement("#Form1") // example: "#form1" as a selector for form with id="form1"
    .then(form => {
        const mappings = [
            {
                FormFieldName: "firstname",
                DataverseFieldName: "firstname",
            },
            {
                FormFieldName: "lastname",
                DataverseFieldName: "lastname",
            },
            {
                FormFieldName: "emailaddress1",
                DataverseFieldName: "emailaddress1",
            },

        ];

        form.addEventListener("submit", (e) => {
            const serializedForm = d365mktformcapture.serializeForm(form, mappings);
            // console.log(JSON.stringify(serializedForm)); // NOTE: enable for debugging
            const payload = serializedForm.SerializedForm.build();

            const captureConfig = {
                FormId: "4d51538b-00cb-f011-bbd3-000d3a33a3d6",
                FormApiUrl: "https://public-usa.mkt.dynamics.com/api/v1.0/orgs/6e80e1eb-af41-4507-9f42-68851f1951c2/landingpageforms"
            }
            d365mktformcapture.submitForm(captureConfig, payload);
        }, true);
    });
</script>

 <!-- CI Journeys Form Embed -->  
  
</body>
</html>
