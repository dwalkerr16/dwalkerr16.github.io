<!DOCTYPE html>
<html>
    <head>        
        
  <!-- CI Journeys Web Tracking Script -->

  <!-- CI Journeys Web Tracking Script -->
        
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>CI Journeys Form Test</title>
        <meta name="referrer" content="never">
        <meta type="xrm/designer/setting" name="type" value="marketing-designer-content-editor-document">
        <meta type="xrm/designer/setting" name="layout-editable" value="marketing-designer-layout-editable">
    </head>
    <body>
<form id="form1">
<input name="firstname" type="text" placeholder="First Name" required>
<input name="lastname" type="text" placeholder="Last Name" required>
<input name="emailaddress1" type="email" placeholder="Email Address" required>
<input name="companyname" type="text" placeholder="Company Name" required>
<input name="message" type="text" placeholder="Message" required>
<button type="submit">Submit</button>
</form>
  <h1>CI Journeys Form Test</h1>

  <!-- CI Journeys Form Embed -->

<script src='https://cxppusa1formui01cdnsa01-endpoint.azureedge.net/usa/FormCapture/FormCapture.bundle.js'></script>
<script>
    // NOTE: for reference see https://go.microsoft.com/fwlink/?linkid=2250770

    d365mktformcapture.waitForElement("#form1") // example: "#form1" as a selector for form with id="form1"
    .then(form => {
        const mappings = [
            {
                FormFieldName: "firstname",
                DataverseFieldName: "firstname",
            },
            {
                FormFieldName: "lastname",
                DataverseFieldName: "lastname",
            },
            {
                FormFieldName: "companyname",
                DataverseFieldName: "companyname",
            },
            {
                FormFieldName: "emailaddress1",
                DataverseFieldName: "emailaddress1",
            },
            {
                FormFieldName: "hdvi_message",
                DataverseFieldName: "hdvi_message",
            },

        ];

        form.addEventListener("submit", (e) => {
            const serializedForm = d365mktformcapture.serializeForm(form, mappings);
            console.log(JSON.stringify(serializedForm)); // NOTE: enable for debugging
            const payload = serializedForm.SerializedForm.build();

            const captureConfig = {
                FormId: "a9155dcb-67ea-f011-8543-7c1e52482fd5",
                FormApiUrl: "https://public-usa.mkt.dynamics.com/api/v1.0/orgs/8514bf74-c346-4f70-bbb3-1a5cb83e0ad4/landingpageforms"
            }
            d365mktformcapture.submitForm(captureConfig, payload);
        }, true);
    });
</script>

 <!-- CI Journeys Form Embed -->  
  
</body>
</html>
